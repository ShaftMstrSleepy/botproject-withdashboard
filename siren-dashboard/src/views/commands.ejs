<!-- src/views/commands.ejs -->
<div class="page-header">
  <h2>Commands</h2>
  <p class="description">
    Manage what commands can be used, and what roles can use them
  </p>
</div>

<!-- Base Commands -->
<section class="command-section">
  <h3>Base Commands</h3>
  <p class="note">These commands are always enabled.</p>
  <ul class="command-list">
    <% (baseCommands || ["Status", "Help", "Plutus Balance"]).forEach(cmd => { %>
      <li class="command-item">
        <span><%= cmd.name || cmd %></span>
        <span class="locked">Always On</span>
      </li>
    <% }) %>
  </ul>
</section>

<!-- Staff Commands -->
<section class="command-section">
  <h3>Staff Commands</h3>
  <ul class="command-list">
    <% (staffCommands || [
      {name:"Add Staff"},{name:"Ban"},{name:"Demote"},{name:"Mute"},{name:"Promote"},
      {name:"Remove Staff"},{name:"Set Rank"},{name:"Staff Help"},
      {name:"Staff Info"},{name:"Un-Ban"},{name:"Un-Mute"},{name:"Warn"}
    ]).forEach(cmd => { %>
      <li class="command-item">
        <span><%= cmd.name || cmd %></span>
        <div class="command-actions">
          <!-- Toggle -->
          <label class="switch">
            <input type="checkbox"
                   name="staff_<%= (cmd.name || cmd).replace(/\s+/g,'').toLowerCase() %>"
                   <%= cmd.toggleable === false ? "disabled" : "" %> />
            <span class="slider round"></span>
          </label>
          <!-- Hamburger for permissions -->
          <button type="button" class="perm-btn" data-command="<%= cmd.name || cmd %>">
            ☰
          </button>
        </div>
      </li>
    <% }) %>
  </ul>
</section>

<!-- Custom Role Commands -->
<section class="command-section">
  <h3>
    Custom Role Commands
    <span class="siren-plus">Siren Plus</span>
  </h3>
  <ul class="command-list">
    <% (customRoleCommands || [
      {name:"Add Custom Role"},
      {name:"Add Co Owner"},
      {name:"Claim Role"},
      {name:"Custom Role"},
      {name:"Custom Role Add"},
      {name:"Custom Role Take"},
      {name:"List Roles"},
      {name:"Purge Role"},
      {name:"Role"},
      {name:"Role Members"},
      {name:"Transfer Role"}
    ]).forEach(cmd => { %>
      <li class="command-item">
        <span><%= cmd.name || cmd %></span>
        <div class="command-actions">
          <% if ((cmd.name || cmd) === "Add Custom Role") { %>
            <label class="switch">
              <input type="checkbox" name="custom_addcustomrole" />
              <span class="slider round"></span>
            </label>
            <button type="button" class="perm-btn" data-command="<%= cmd.name || cmd %>">
              ☰
            </button>
          <% } else { %>
            <span class="locked">Base Command</span>
          <% } %>
        </div>
      </li>
    <% }) %>
  </ul>
</section>

<!-- Permission Modal -->
<div id="permissionModal" class="modal hidden">
  <div class="modal-content">
    <h4 id="modalTitle">Permissions</h4>
    <p>Limit this command to certain roles:</p>
    <select id="roleSelect" class="multi" multiple>
      <% (roles || []).forEach(r => { %>
        <option value="<%= r.id %>"><%= r.name %></option>
      <% }) %>
    </select>
    <button id="savePerms">Save</button>
  </div>
</div>